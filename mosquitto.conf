# Configuração Eclipse Mosquitto ACELERADA para Railway
# Implementa cache em memória e otimizações avançadas

listener 1883 0.0.0.0
protocol mqtt

listener 9001 0.0.0.0
protocol websockets

# Autenticação
allow_anonymous false
password_file /mosquitto/config/password_file

# === MODO ACELERADOR ===
# Cache em memória - sem persistência para máxima velocidade
persistence false

# Configurações ULTRA-OTIMIZADAS para Railway
max_keepalive 300
max_inflight_messages 500
max_inflight_bytes 0
max_queued_messages 10000
max_queued_bytes 0
queue_qos0_messages true

# === ACELERAÇÃO TCP ===
# Principal otimização: TCP_NODELAY elimina delay de Nagle
set_tcp_nodelay true

# Limites aumentados para throughput máximo
max_packet_size 134217728
memory_limit 1073741824

# === CONFIGURAÇÕES DE REDE OTIMIZADAS ===
max_connections -1
sys_interval 5
autosave_interval 0

# WebSocket com buffer aumentado
websockets_headers_size 8192

# === CONFIGURAÇÕES DE ACELERAÇÃO ESPECÍFICAS ===
# Configurações específicas removidas (depreciadas na v2.0.22)

# === LOGGING OTIMIZADO PARA PRODUCTION ===
log_dest stdout
log_type error
log_type warning
log_type notice
log_timestamp true
log_timestamp_format %H:%M:%S